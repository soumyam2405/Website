{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nvar _jsxFileName = \"F:\\\\DiscordHookSite\\\\common\\\\layout\\\\Section.tsx\",\n    _s = $RefreshSig$();\n\nimport { animated, useSpring } from \"@react-spring/web\";\nimport { Observer } from \"mobx-react-lite\";\nimport { ellipsis } from \"polished\";\nimport React, { useEffect, useRef, useState } from \"react\";\nimport styled, { css, useTheme } from \"styled-components\";\nimport { chevron } from \"../../icons/chevron\";\nimport { error } from \"../../icons/error\";\nimport { useMeasure } from \"../dom/useMeasure\";\nimport { usePreference } from \"../settings/usePreference\";\nimport { usePrevious } from \"../state/usePrevious\";\nimport { ActionButtons } from \"./ActionButtons\";\nimport { SCREEN_TINY } from \"./breakpoints\";\nimport { Icon } from \"./Icon\";\nimport { IconButton } from \"./IconButton\";\nconst Container = styled(animated.section).withConfig({\n  displayName: \"Section__Container\",\n  componentId: \"sc-16nv4v-0\"\n})([\"display:flex;\", \";\", \";\"], ({\n  variant\n}) => (variant === \"normal\" || variant === \"indented\") && css([\"margin:-8px;padding:0 8px;\"]), ({\n  variant\n}) => variant === \"large\" && css([\"border-radius:4px;box-shadow:\", \";\"], ({\n  theme\n}) => theme.elavation.medium));\n_c = Container;\nconst ColorPreview = styled.div.withConfig({\n  displayName: \"Section__ColorPreview\",\n  componentId: \"sc-16nv4v-1\"\n})([\"width:4px;\"]);\n_c2 = ColorPreview;\nconst SectionContent = styled.div.withConfig({\n  displayName: \"Section__SectionContent\",\n  componentId: \"sc-16nv4v-2\"\n})([\"flex:1;\", \";\"], ({\n  variant\n}) => variant === \"large\" && css([\"border:1px solid \", \";border-left:none;padding:15px;border-radius:0 4px 4px 0;\"], ({\n  theme\n}) => theme.background.secondaryAlt));\n_c3 = SectionContent;\nconst Header = styled.div.withConfig({\n  displayName: \"Section__Header\",\n  componentId: \"sc-16nv4v-3\"\n})([\"display:grid;grid-template-columns:1fr max-content;height:32px;\", \"\"], ({\n  variant\n}) => variant === \"large\" && css([\"margin:-8px 0;\"]));\n_c4 = Header;\nconst HeaderContent = styled.div.withConfig({\n  displayName: \"Section__HeaderContent\",\n  componentId: \"sc-16nv4v-4\"\n})([\"min-width:0;height:100%;display:flex;align-items:center;\"]);\n_c5 = HeaderContent;\nconst CollapseIcon = styled(IconButton).withConfig({\n  displayName: \"Section__CollapseIcon\",\n  componentId: \"sc-16nv4v-5\"\n})([\"margin-left:-8px;transform:rotate(90deg);transition:transform 150ms;\", \";\"], ({\n  open\n}) => open && css([\"transform:rotate(180deg);\"]));\n_c6 = CollapseIcon;\nconst Title = styled.h2.withConfig({\n  displayName: \"Section__Title\",\n  componentId: \"sc-16nv4v-6\"\n})([\"\", \";margin:-8px 0;padding:8px 0;font-size:16px;font-weight:500;color:\", \";user-select:none;\", \";\"], ellipsis(), ({\n  theme\n}) => theme.header.secondary, ({\n  variant\n}) => variant === \"large\" && css([\"font-size:18px;line-height:16px;color:\", \";\"], ({\n  theme\n}) => theme.header.primary));\n_c7 = Title;\nconst ValidationError = styled(animated.div).withConfig({\n  displayName: \"Section__ValidationError\",\n  componentId: \"sc-16nv4v-7\"\n})([\"color:\", \";margin-right:8px;\"], ({\n  theme\n}) => theme.accent.danger);\n_c8 = ValidationError;\nconst Content = styled.div.withConfig({\n  displayName: \"Section__Content\",\n  componentId: \"sc-16nv4v-8\"\n})([\"&:not(:empty){padding-top:\", \"px;padding-bottom:\", \"px;\", \"}\"], ({\n  variant\n}) => variant === \"large\" ? 16 : 8, ({\n  variant\n}) => variant === \"large\" ? 0 : 8, ({\n  variant\n}) => variant === \"indented\" && css([\"padding-left:24px;\", \"{padding-left:12px;}\"], SCREEN_TINY));\n_c9 = Content;\nexport function Section(props) {\n  _s();\n\n  const {\n    children,\n    name,\n    variant = \"normal\",\n    actions,\n    color,\n    hasError = false\n  } = props;\n  const expandSections = usePreference(\"expandSections\");\n  const containerRef = useRef(null);\n  const {\n    0: open,\n    1: setOpen\n  } = useState(expandSections);\n  const previousOpen = usePrevious(open);\n  const {\n    0: visible,\n    1: setVisible\n  } = useState(open);\n  const frameRef = useRef();\n  useEffect(() => {\n    return () => {\n      if (frameRef.current) cancelAnimationFrame(frameRef.current);\n    };\n  }, []);\n\n  const toggleOpen = force => {\n    frameRef.current = requestAnimationFrame(() => {\n      setVisible(true);\n      frameRef.current = requestAnimationFrame(() => {\n        setOpen(force !== null && force !== void 0 ? force : open => !open);\n      });\n    });\n  };\n\n  const previousExpandSections = usePrevious(expandSections);\n  useEffect(() => {\n    if (previousExpandSections !== expandSections && open !== expandSections) {\n      toggleOpen(expandSections);\n    }\n  }, [expandSections, open, previousExpandSections]);\n  const [ref, {\n    height: contentHeight\n  }] = useMeasure();\n  const style = useSpring({\n    config: {\n      tension: 250,\n      clamp: true\n    },\n    height: (variant === \"large\" ? 48 : 32) + (open ? contentHeight + 16 : 0),\n    onRest: () => setVisible(open)\n  });\n  const errorStyle = useSpring({\n    config: {\n      tension: 300,\n      clamp: true\n    },\n    opacity: Number(hasError)\n  });\n  const theme = useTheme();\n  return /*#__PURE__*/_jsxDEV(Container, {\n    variant: variant,\n    ref: containerRef,\n    style: {\n      overflow: \"hidden\",\n      height: open && previousOpen ? \"auto\" : style.height\n    },\n    children: [color && /*#__PURE__*/_jsxDEV(Observer, {\n      children: () => {\n        var _color$hex;\n\n        return /*#__PURE__*/_jsxDEV(ColorPreview, {\n          style: {\n            backgroundColor: (_color$hex = color.hex) !== null && _color$hex !== void 0 ? _color$hex : theme.background.secondaryAlt\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 13\n        }, this);\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(SectionContent, {\n      variant: variant,\n      children: [/*#__PURE__*/_jsxDEV(Header, {\n        variant: variant,\n        children: [/*#__PURE__*/_jsxDEV(HeaderContent, {\n          onClick: () => toggleOpen(),\n          children: [/*#__PURE__*/_jsxDEV(CollapseIcon, {\n            open: open,\n            icon: chevron,\n            label: `${open ? \"Collapse\" : \"Expand\"} ${name}`,\n            tooltip: false\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 222,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Title, {\n            variant: variant,\n            children: name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 228,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(ValidationError, {\n            style: errorStyle,\n            children: /*#__PURE__*/_jsxDEV(Icon, {\n              children: error\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 230,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 229,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 221,\n          columnNumber: 11\n        }, this), actions && /*#__PURE__*/_jsxDEV(ActionButtons, {\n          actions: actions\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 23\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Content, {\n        variant: variant,\n        ref: ref,\n        children: visible && children\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 200,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Section, \"yGlYk7H76iGYofm5e73Yt5y6uws=\", false, function () {\n  return [usePreference, usePrevious, usePrevious, useMeasure, useSpring, useSpring, useTheme];\n});\n\n_c10 = Section;\n\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c10;\n\n$RefreshReg$(_c, \"Container\");\n$RefreshReg$(_c2, \"ColorPreview\");\n$RefreshReg$(_c3, \"SectionContent\");\n$RefreshReg$(_c4, \"Header\");\n$RefreshReg$(_c5, \"HeaderContent\");\n$RefreshReg$(_c6, \"CollapseIcon\");\n$RefreshReg$(_c7, \"Title\");\n$RefreshReg$(_c8, \"ValidationError\");\n$RefreshReg$(_c9, \"Content\");\n$RefreshReg$(_c10, \"Section\");","map":{"version":3,"sources":["F:/DiscordHookSite/common/layout/Section.tsx"],"names":["animated","useSpring","Observer","ellipsis","React","useEffect","useRef","useState","styled","css","useTheme","chevron","error","useMeasure","usePreference","usePrevious","ActionButtons","SCREEN_TINY","Icon","IconButton","Container","section","variant","theme","elavation","medium","ColorPreview","div","SectionContent","background","secondaryAlt","Header","HeaderContent","CollapseIcon","open","Title","h2","header","secondary","primary","ValidationError","accent","danger","Content","Section","props","children","name","actions","color","hasError","expandSections","containerRef","setOpen","previousOpen","visible","setVisible","frameRef","current","cancelAnimationFrame","toggleOpen","force","requestAnimationFrame","previousExpandSections","ref","height","contentHeight","style","config","tension","clamp","onRest","errorStyle","opacity","Number","overflow","backgroundColor","hex"],"mappings":"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","sourcesContent":["import { animated, useSpring } from \"@react-spring/web\"\r\nimport { Observer } from \"mobx-react-lite\"\r\nimport { ellipsis } from \"polished\"\r\nimport React, { ReactNode, useEffect, useRef, useState } from \"react\"\r\nimport styled, { css, useTheme } from \"styled-components\"\r\nimport { chevron } from \"../../icons/chevron\"\r\nimport { error } from \"../../icons/error\"\r\nimport { useMeasure } from \"../dom/useMeasure\"\r\nimport type { ColorLike } from \"../input/color/ColorModel\"\r\nimport { usePreference } from \"../settings/usePreference\"\r\nimport { usePrevious } from \"../state/usePrevious\"\r\nimport { Action, ActionButtons } from \"./ActionButtons\"\r\nimport { SCREEN_TINY } from \"./breakpoints\"\r\nimport { Icon } from \"./Icon\"\r\nimport { IconButton } from \"./IconButton\"\r\n\r\ntype SectionVariant = \"normal\" | \"indented\" | \"large\"\r\n\r\nconst Container = styled(animated.section)<{ variant: SectionVariant }>`\r\n  display: flex;\r\n\r\n  ${({ variant }) =>\r\n    (variant === \"normal\" || variant === \"indented\") &&\r\n    css`\r\n      margin: -8px;\r\n      padding: 0 8px;\r\n    `};\r\n\r\n  ${({ variant }) =>\r\n    variant === \"large\" &&\r\n    css`\r\n      border-radius: 4px;\r\n\r\n      box-shadow: ${({ theme }) => theme.elavation.medium};\r\n    `};\r\n`\r\n\r\nconst ColorPreview = styled.div`\r\n  width: 4px;\r\n`\r\n\r\nconst SectionContent = styled.div<{ variant: SectionVariant }>`\r\n  flex: 1;\r\n\r\n  ${({ variant }) =>\r\n    variant === \"large\" &&\r\n    css`\r\n      border: 1px solid ${({ theme }) => theme.background.secondaryAlt};\r\n      border-left: none;\r\n\r\n      padding: 15px;\r\n\r\n      border-radius: 0 4px 4px 0;\r\n    `};\r\n`\r\n\r\nconst Header = styled.div<{ variant: SectionVariant }>`\r\n  display: grid;\r\n  grid-template-columns: 1fr max-content;\r\n\r\n  height: 32px;\r\n\r\n  ${({ variant }) =>\r\n    variant === \"large\" &&\r\n    css`\r\n      margin: -8px 0;\r\n    `}\r\n`\r\n\r\nconst HeaderContent = styled.div`\r\n  min-width: 0;\r\n  height: 100%;\r\n\r\n  display: flex;\r\n  align-items: center;\r\n`\r\n\r\nconst CollapseIcon = styled(IconButton)<{ open: boolean }>`\r\n  margin-left: -8px;\r\n\r\n  transform: rotate(90deg);\r\n  transition: transform 150ms;\r\n\r\n  ${({ open }) =>\r\n    open &&\r\n    css`\r\n      transform: rotate(180deg);\r\n    `};\r\n`\r\n\r\nconst Title = styled.h2<{ variant: SectionVariant }>`\r\n  ${ellipsis()};\r\n\r\n  margin: -8px 0;\r\n  padding: 8px 0;\r\n\r\n  font-size: 16px;\r\n  font-weight: 500;\r\n  color: ${({ theme }) => theme.header.secondary};\r\n\r\n  user-select: none;\r\n\r\n  ${({ variant }) =>\r\n    variant === \"large\" &&\r\n    css`\r\n      font-size: 18px;\r\n      line-height: 16px;\r\n\r\n      color: ${({ theme }) => theme.header.primary};\r\n    `};\r\n`\r\n\r\nconst ValidationError = styled(animated.div)`\r\n  color: ${({ theme }) => theme.accent.danger};\r\n  margin-right: 8px;\r\n`\r\n\r\nconst Content = styled.div<{ variant: SectionVariant }>`\r\n  &:not(:empty) {\r\n    padding-top: ${({ variant }) => (variant === \"large\" ? 16 : 8)}px;\r\n    padding-bottom: ${({ variant }) => (variant === \"large\" ? 0 : 8)}px;\r\n\r\n    ${({ variant }) =>\r\n      variant === \"indented\" &&\r\n      css`\r\n        padding-left: 24px;\r\n\r\n        ${SCREEN_TINY} {\r\n          padding-left: 12px;\r\n        }\r\n      `}\r\n  }\r\n`\r\n\r\nexport type SectionProps = {\r\n  children?: ReactNode\r\n  name: string\r\n  variant?: SectionVariant\r\n  actions?: Action[]\r\n  color?: ColorLike\r\n  hasError?: boolean\r\n}\r\n\r\nexport function Section(props: SectionProps) {\r\n  const {\r\n    children,\r\n    name,\r\n    variant = \"normal\",\r\n    actions,\r\n    color,\r\n    hasError = false,\r\n  } = props\r\n\r\n  const expandSections = usePreference(\"expandSections\")\r\n\r\n  const containerRef = useRef<HTMLElement>(null)\r\n  const [open, setOpen] = useState(expandSections)\r\n  const previousOpen = usePrevious(open)\r\n\r\n  const [visible, setVisible] = useState(open)\r\n\r\n  const frameRef = useRef<number>()\r\n  useEffect(() => {\r\n    return () => {\r\n      if (frameRef.current) cancelAnimationFrame(frameRef.current)\r\n    }\r\n  }, [])\r\n\r\n  const toggleOpen = (force?: boolean) => {\r\n    frameRef.current = requestAnimationFrame(() => {\r\n      setVisible(true)\r\n      frameRef.current = requestAnimationFrame(() => {\r\n        setOpen(force ?? (open => !open))\r\n      })\r\n    })\r\n  }\r\n\r\n  const previousExpandSections = usePrevious(expandSections)\r\n  useEffect(() => {\r\n    if (previousExpandSections !== expandSections && open !== expandSections) {\r\n      toggleOpen(expandSections)\r\n    }\r\n  }, [expandSections, open, previousExpandSections])\r\n\r\n  const [ref, { height: contentHeight }] = useMeasure()\r\n  const style = useSpring({\r\n    config: { tension: 250, clamp: true },\r\n    height: (variant === \"large\" ? 48 : 32) + (open ? contentHeight + 16 : 0),\r\n    onRest: () => setVisible(open),\r\n  })\r\n\r\n  const errorStyle = useSpring({\r\n    config: { tension: 300, clamp: true },\r\n    opacity: (Number(hasError) as unknown) as undefined,\r\n  })\r\n\r\n  const theme = useTheme()\r\n\r\n  return (\r\n    <Container\r\n      variant={variant}\r\n      ref={containerRef}\r\n      style={{\r\n        overflow: \"hidden\",\r\n        height: open && previousOpen ? \"auto\" : style.height,\r\n      }}\r\n    >\r\n      {color && (\r\n        <Observer>\r\n          {() => (\r\n            <ColorPreview\r\n              style={{\r\n                backgroundColor: color.hex ?? theme.background.secondaryAlt,\r\n              }}\r\n            />\r\n          )}\r\n        </Observer>\r\n      )}\r\n      <SectionContent variant={variant}>\r\n        <Header variant={variant}>\r\n          <HeaderContent onClick={() => toggleOpen()}>\r\n            <CollapseIcon\r\n              open={open}\r\n              icon={chevron}\r\n              label={`${open ? \"Collapse\" : \"Expand\"} ${name}`}\r\n              tooltip={false}\r\n            />\r\n            <Title variant={variant}>{name}</Title>\r\n            <ValidationError style={errorStyle}>\r\n              <Icon>{error}</Icon>\r\n            </ValidationError>\r\n          </HeaderContent>\r\n          {actions && <ActionButtons actions={actions} />}\r\n        </Header>\r\n        <Content variant={variant} ref={ref}>\r\n          {visible && children}\r\n        </Content>\r\n      </SectionContent>\r\n    </Container>\r\n  )\r\n}\r\n"]},"metadata":{},"sourceType":"module"}