{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"F:\\\\DiscordHookSite\\\\modules\\\\editor\\\\message\\\\MessageEditor.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { useObserver } from \"mobx-react-lite\";\nimport { applyPatch } from \"mobx-state-tree\";\nimport dynamic from \"next/dynamic\";\nimport React from \"react\";\nimport styled from \"styled-components\";\nimport { PrimaryButton } from \"../../../common/input/button/PrimaryButton\";\nimport { SecondaryButton } from \"../../../common/input/button/SecondaryButton\";\nimport { InputError } from \"../../../common/input/error/InputError\";\nimport { InputField } from \"../../../common/input/text/InputField\";\nimport { ButtonList } from \"../../../common/layout/ButtonList\";\nimport { Stack } from \"../../../common/layout/Stack\";\nimport { ModalManagerContext } from \"../../../common/modal/ModalManagerContext\";\nimport { useRequiredContext } from \"../../../common/state/useRequiredContext\";\nimport { Markdown } from \"../../markdown/Markdown\";\nimport { EditorManagerContext } from \"../EditorManagerContext\";\nimport { EmbedEditor } from \"./EmbedEditor\";\nimport { PrimaryContentEditor } from \"./PrimaryContentEditor\";\nconst DataEditorModal = dynamic(async () => import(\"../data/DataEditorModal\").then(module => module.DataEditorModal), {\n  loadableGenerated: {\n    webpack: () => [require.resolveWeak(\"../data/DataEditorModal\")],\n    modules: [\"../data/DataEditorModal\"]\n  }\n});\nconst Message = styled(Markdown).withConfig({\n  displayName: \"MessageEditor__Message\",\n  componentId: \"gy799t-0\"\n})([\"margin-top:-8px;font-size:15px;\"]);\nconst EmbedValidationErrorContainer = styled.div.withConfig({\n  displayName: \"MessageEditor__EmbedValidationErrorContainer\",\n  componentId: \"gy799t-1\"\n})([\"margin-bottom:8px;&:empty{margin:0;}\"]);\nexport function MessageEditor(props) {\n  const {\n    message,\n    form\n  } = props;\n  const modalManager = useRequiredContext(ModalManagerContext);\n  const editorManager = useRequiredContext(EditorManagerContext);\n\n  const spawnDataEditorModal = () => modalManager.spawn({\n    render: () => /*#__PURE__*/_jsxDEV(DataEditorModal, {\n      message: message\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 53,\n      columnNumber: 21\n    }, this)\n  });\n\n  return useObserver(() => /*#__PURE__*/_jsxDEV(Stack, {\n    gap: 16,\n    children: [/*#__PURE__*/_jsxDEV(PrimaryContentEditor, {\n      message: message,\n      form: form\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }, this), message.embeds.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(EmbedValidationErrorContainer, {\n        children: /*#__PURE__*/_jsxDEV(InputError, {\n          error: message.embedLength > 6000 ? \"Embeds exceed 6000 character limit\" : undefined\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Stack, {\n        gap: 16,\n        children: message.embeds.map((embed, index) => /*#__PURE__*/_jsxDEV(EmbedEditor, {\n          embed: embed,\n          form: form.repeatingForm(\"embeds\").index(index)\n        }, embed.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(PrimaryButton, {\n        disabled: message.size >= 10,\n        onClick: () => {\n          form.repeatingForm(\"embeds\").push({}, [\"timestamp\"]);\n        },\n        children: \"Add Embed\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(InputField, _objectSpread({\n      id: `_${message.id}_reference`,\n      label: \"Message Link\",\n      placeholder: \"https://discord.com/channels/...\",\n      error: form.field(\"reference\").error\n    }, form.field(\"reference\").inputProps), void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(Message, {\n      content: \"*When a message link is set, pressing submit or edit will edit the\" + \" message sent inside of Discord. To load a message sent in Discord, use\" + \" the bot's 'restore' command.*\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(ButtonList, {\n      children: [editorManager.messages.length > 1 && /*#__PURE__*/_jsxDEV(SecondaryButton, {\n        onClick: () => {\n          applyPatch(form.state.value, [{\n            op: \"remove\",\n            path: form.path\n          }]);\n        },\n        children: \"Remove Message\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(SecondaryButton, {\n        onClick: () => spawnDataEditorModal(),\n        children: \"JSON Data Editor\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 105,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 57,\n    columnNumber: 5\n  }, this));\n}","map":{"version":3,"sources":["F:/DiscordHookSite/modules/editor/message/MessageEditor.tsx"],"names":["useObserver","applyPatch","dynamic","React","styled","PrimaryButton","SecondaryButton","InputError","InputField","ButtonList","Stack","ModalManagerContext","useRequiredContext","Markdown","EditorManagerContext","EmbedEditor","PrimaryContentEditor","DataEditorModal","then","module","Message","EmbedValidationErrorContainer","div","MessageEditor","props","message","form","modalManager","editorManager","spawnDataEditorModal","spawn","render","embeds","length","embedLength","undefined","map","embed","index","repeatingForm","id","size","push","field","error","inputProps","messages","state","value","op","path"],"mappings":"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","sourcesContent":["import { useObserver } from \"mobx-react-lite\"\r\nimport { applyPatch } from \"mobx-state-tree\"\r\nimport dynamic from \"next/dynamic\"\r\nimport React from \"react\"\r\nimport styled from \"styled-components\"\r\nimport { PrimaryButton } from \"../../../common/input/button/PrimaryButton\"\r\nimport { SecondaryButton } from \"../../../common/input/button/SecondaryButton\"\r\nimport { InputError } from \"../../../common/input/error/InputError\"\r\nimport { InputField } from \"../../../common/input/text/InputField\"\r\nimport { ButtonList } from \"../../../common/layout/ButtonList\"\r\nimport { Stack } from \"../../../common/layout/Stack\"\r\nimport { ModalManagerContext } from \"../../../common/modal/ModalManagerContext\"\r\nimport { useRequiredContext } from \"../../../common/state/useRequiredContext\"\r\nimport { Markdown } from \"../../markdown/Markdown\"\r\nimport type { MessageItemFormState } from \"../../message/state/editorForm\"\r\nimport type { EmbedLike } from \"../../message/state/models/EmbedModel\"\r\nimport type { MessageLike } from \"../../message/state/models/MessageModel\"\r\nimport type { DataEditorModalProps } from \"../data/DataEditorModal\"\r\nimport { EditorManagerContext } from \"../EditorManagerContext\"\r\nimport { EmbedEditor } from \"./EmbedEditor\"\r\nimport { PrimaryContentEditor } from \"./PrimaryContentEditor\"\r\n\r\nconst DataEditorModal = dynamic<DataEditorModalProps>(async () =>\r\n  import(\"../data/DataEditorModal\").then(module => module.DataEditorModal),\r\n)\r\n\r\nconst Message = styled(Markdown)`\r\n  margin-top: -8px;\r\n  font-size: 15px;\r\n`\r\n\r\nconst EmbedValidationErrorContainer = styled.div`\r\n  margin-bottom: 8px;\r\n\r\n  &:empty {\r\n    margin: 0;\r\n  }\r\n`\r\n\r\nexport type MessageEditorProps = {\r\n  message: MessageLike\r\n  form: MessageItemFormState\r\n}\r\n\r\nexport function MessageEditor(props: MessageEditorProps) {\r\n  const { message, form } = props\r\n\r\n  const modalManager = useRequiredContext(ModalManagerContext)\r\n  const editorManager = useRequiredContext(EditorManagerContext)\r\n\r\n  const spawnDataEditorModal = () =>\r\n    modalManager.spawn({\r\n      render: () => <DataEditorModal message={message} />,\r\n    })\r\n\r\n  return useObserver(() => (\r\n    <Stack gap={16}>\r\n      <PrimaryContentEditor message={message} form={form} />\r\n      {message.embeds.length > 0 && (\r\n        <div>\r\n          <EmbedValidationErrorContainer>\r\n            <InputError\r\n              error={\r\n                message.embedLength > 6000\r\n                  ? \"Embeds exceed 6000 character limit\"\r\n                  : undefined\r\n              }\r\n            />\r\n          </EmbedValidationErrorContainer>\r\n          <Stack gap={16}>\r\n            {message.embeds.map((embed, index) => (\r\n              <EmbedEditor\r\n                key={embed.id}\r\n                embed={embed}\r\n                form={form.repeatingForm(\"embeds\").index(index)}\r\n              />\r\n            ))}\r\n          </Stack>\r\n        </div>\r\n      )}\r\n      <div>\r\n        <PrimaryButton\r\n          disabled={message.size >= 10}\r\n          onClick={() => {\r\n            form.repeatingForm(\"embeds\").push({} as EmbedLike, [\"timestamp\"])\r\n          }}\r\n        >\r\n          Add Embed\r\n        </PrimaryButton>\r\n      </div>\r\n      <InputField\r\n        id={`_${message.id}_reference`}\r\n        label=\"Message Link\"\r\n        placeholder=\"https://discord.com/channels/...\"\r\n        error={form.field(\"reference\").error}\r\n        {...form.field(\"reference\").inputProps}\r\n      />\r\n      <Message\r\n        content={\r\n          \"*When a message link is set, pressing submit or edit will edit the\" +\r\n          \" message sent inside of Discord. To load a message sent in Discord, use\" +\r\n          \" the bot's 'restore' command.*\"\r\n        }\r\n      />\r\n      <ButtonList>\r\n        {editorManager.messages.length > 1 && (\r\n          <SecondaryButton\r\n            onClick={() => {\r\n              applyPatch(form.state.value, [\r\n                {\r\n                  op: \"remove\",\r\n                  path: form.path,\r\n                },\r\n              ])\r\n            }}\r\n          >\r\n            Remove Message\r\n          </SecondaryButton>\r\n        )}\r\n        <SecondaryButton onClick={() => spawnDataEditorModal()}>\r\n          JSON Data Editor\r\n        </SecondaryButton>\r\n      </ButtonList>\r\n    </Stack>\r\n  ))\r\n}\r\n"]},"metadata":{},"sourceType":"module"}